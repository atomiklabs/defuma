(this["webpackJsonp@atomiklabs/web-ui"]=this["webpackJsonp@atomiklabs/web-ui"]||[]).push([[0],{1110:function(e,t){},1119:function(e,t){},1121:function(e,t){},1188:function(e,t){},1285:function(e,t){},1427:function(e,t){},1478:function(e,t){},1502:function(e,t){},1504:function(e,t){},1530:function(e,t){},1682:function(e,t){},1782:function(e,t){},1784:function(e,t){},1793:function(e,t){},1844:function(e,t){},1886:function(e,t,n){},1887:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n.n(r),c=n(723),i=n.n(c),s=(n(742),n(117)),u=n(735),o=n(268),l=n(271),m=n(734),f=n(726),d=n.n(f),p=n(727),b={address:n.n(p).a,abi:d.a},v=n(79),y=n(0),h=n.n(y),E=n(30),g=n(728),k=function(){var e=Object(s.b)().library,t=Object(l.b)([b.address,"providersCount"]),n=t.data,c=t.mutate,i=n&&n.toNumber(),u=Object(r.useState)(""),m=Object(v.a)(u,2),f=m[0],d=m[1],p=Object(r.useState)([]),y=Object(v.a)(p,2),g=y[0],k=y[1],N=new o.ethers.Contract(b.address,b.abi,e.getSigner());Object(r.useEffect)((function(){var t=N.filters.Provider();return e.on(t,(function(e){console.log("Emitting 'Provider'")})),function(){e.removeAllListeners(t)}}),[]),Object(r.useEffect)((function(){i&&x()}),[i]);var w=function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,N.registerProvider(f);case 4:c(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(E.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=1;case 2:if(!(n<=i)){e.next=10;break}return e.next=5,N.providers(n);case 5:r=e.sent,t.push(r);case 7:n++,e.next=2;break;case 10:k(t);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("form",{className:"form-inline",onSubmit:w},a.a.createElement("div",{className:"form-group mx-sm-3 mb-2"},a.a.createElement("label",{className:"mr-2"},"Product schema:"),a.a.createElement("input",{type:"text",className:"form-control",placeholder:"{ ... }",value:f,onChange:function(e){return d(e.target.value)}})),a.a.createElement("button",{type:"submit",className:"btn btn-dark mb-2"},"Add Product")),a.a.createElement("div",{className:"card-header"},"Schemas:"),a.a.createElement("ul",{className:"list-group list-group-flush"},g.map((function(e,t){return a.a.createElement("li",{key:t,className:"list-group-item"},e)}))))},N=n(733),w=function(e){var t=Object(r.useState)(null),n=Object(v.a)(t,2),c=n[0],i=n[1],u=Object(s.b)().account;return Object(r.useEffect)((function(){Object(E.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i,e.next=3,new g.a;case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))()}),[]),console.log("user ",c),c?(e.setIsLogged(!0),a.a.createElement("div",null,a.a.createElement("div",{className:"card mb-3"},a.a.createElement("div",{className:"card-body"},a.a.createElement("h5",{className:"card-title"},"Welcome to DeFuMA!"),a.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},u),a.a.createElement("br",null),a.a.createElement("div",{className:"card-text"},a.a.createElement("div",{className:"card-header"},"My details:"),a.a.createElement("ul",{className:"list-group list-group-flush"},a.a.createElement("li",{className:"list-group-item"},a.a.createElement("span",{className:"font-weight-bold"},"Public key: "),c.publicKey),a.a.createElement("li",{className:"list-group-item"},a.a.createElement("span",{className:"font-weight-bold"},"Threads: "),"[ ]"))))),a.a.createElement("div",{className:"card mb-3"},a.a.createElement("div",{className:"card-body"},a.a.createElement(k,null))),a.a.createElement("div",{className:"card"},a.a.createElement("div",{className:"card-body"},a.a.createElement(N.a,{userApiKey:"bxikmslquguiw6zcmmcm7glzvtm",userApiSecret:"",bucketName:"files-miki"}))))):a.a.createElement(x,null)},x=function(){return a.a.createElement("div",{className:"side-load"},a.a.createElement("div",{className:"d-flex justify-content-center"},a.a.createElement("div",{className:"spinner-border",role:"status"},a.a.createElement("span",{className:"sr-only"},"Loading..."))))},S=function(){var e=Object(s.b)(),t=(e.chainId,e.account),n=e.active,c=Object(r.useState)(!1),i=Object(v.a)(c,2),u=i[0],o=i[1];return n?a.a.createElement("div",null,a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-5"},a.a.createElement("div",{className:"sidenav"},a.a.createElement("div",{className:"login-main-text"},a.a.createElement("h2",null,"Decentralised Full-Market"),a.a.createElement("p",null,u?"Logged: "+t:"Login with Metamask (Rinkeby) to access.")),a.a.createElement("div",{className:"main"},a.a.createElement("div",{className:"col-md-6 col-sm-12"},a.a.createElement("div",{className:"login-form"}))))),a.a.createElement("div",{className:"col-7 align-self-center side-content"},n&&a.a.createElement(w,{setIsLogged:o})))):a.a.createElement("div",null)},j=(n(1886),new u.a({})),O=new Map([[b.address,b.abi]]),P=function(){return a.a.createElement(s.a,{getLibrary:L},a.a.createElement(I,null))},I=function(){var e=Object(s.b)(),t=e.library,n=e.activate;return Object(r.useEffect)((function(){n(j)}),[]),a.a.createElement(l.a,{value:{fetcher:Object(m.a)(t,O)}},a.a.createElement(S,null))},L=function(e){return new o.ethers.providers.Web3Provider(e)};i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(P,null)),document.getElementById("root"))},306:function(e,t){},726:function(e,t){e.exports=[{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"provider",type:"string"}],name:"Provider",type:"event"},{inputs:[{internalType:"address",name:"providerAddress",type:"address"},{internalType:"string",name:"hash",type:"string"}],name:"addProviderData",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"providerData",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"providers",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"providersCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"providerAddress",type:"string"}],name:"registerProvider",outputs:[],stateMutability:"nonpayable",type:"function"}]},727:function(e,t){e.exports="0xB235025736b4345be27bBac71AEd29b6F6522842"},728:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var r=n(11),a=n(0),c=n.n(a),i=n(79),s=n(30),u=n(270),o=n(70),l=n(729),m=n.n(l),f=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r,a,s,u,l,f,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.create(window.ethereum);case 2:return t=e.sent,e.next=5,window.ethereum.enable();case 5:return n=e.sent,r=Object(i.a)(n,1),a=r[0],e.next=10,t.auth([],{address:a});case 10:return e.next=12,t.openSpace("io-textile-dropzone");case 12:return s=e.sent,e.next=15,t.syncDone;case 15:return e.prev=15,e.next=18,s.private.get("identity");case 18:if(null!==(u=e.sent)){e.next=21;break}throw new Error("No identity");case 21:return e.next=23,o.Libp2pCryptoIdentity.fromString(u);case 23:return l=e.sent,e.abrupt("return",l);case 27:return e.prev=27,e.t0=e.catch(15),e.next=31,o.Libp2pCryptoIdentity.fromRandom();case 31:return f=e.sent,d=f.toString(),e.next=35,s.private.set("identity",d);case 35:return e.abrupt("return",f);case 36:case"end":return e.stop()}}),e,null,[[15,27]])})));return function(){return e.apply(this,arguments)}}(),d=function(t){return function(){return new Promise((function(n,r){var a=window.location.origin.replace(/^http/,"ws"),i=new WebSocket(a+"/ws/userauth");i.onopen=function(){var a=t.public.toString();i.send(JSON.stringify({pubkey:a,type:"token"})),i.onmessage=function(){var a=Object(s.a)(c.a.mark((function a(s){var u,o,l;return c.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:u=JSON.parse(s.data),a.t0=u.type,a.next="error"===a.t0?4:"challenge"===a.t0?6:"token"===a.t0?12:14;break;case 4:return r(u.value),a.abrupt("break",14);case 6:return o=e.from(u.value),a.next=9,t.sign(o);case 9:return l=a.sent,i.send(JSON.stringify({type:"challenge",sig:e.from(l).toJSON()})),a.abrupt("break",14);case 12:return n(u.value),a.abrupt("break",14);case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}}))}},p=function e(){var t=this;return Object(r.a)(this,e),this.id=void 0,this.client=void 0,this.identity=void 0,this.publicKey=void 0,this.threads=void 0,this.init=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setupIdentity();case 2:return e.next=4,t.login();case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),this.sign=function(){var e=Object(s.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw Error("No user ID found");case 2:return e.abrupt("return",t.id.sign(n));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setupIdentity=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:t.id=e.sent,t.identity=t.id.toString(),t.publicKey=t.id.public.toString();case 5:case"end":return e.stop()}}),e)}))),this.listThreads=Object(s.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.client){e.next=2;break}throw Error("User not authenticated");case 2:return e.next=4,t.client.listThreads();case 4:n=e.sent,t.threads=JSON.stringify(n.listList);case 6:case"end":return e.stop()}}),e)}))),this.login=Object(s.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw Error("No user ID found");case 2:n=d(t.id),t.client=u.Client.withUserAuth(n),console.log("Logged in: verified on Textile API");case 5:case"end":return e.stop()}}),e)}))),this.init()}}).call(this,n(1).Buffer)},733:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(7),a=n.n(r),c=n(270),i=n(70);"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function s(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}var u="index.json";function o(t){var n=t.userApiKey,a=t.userApiSecret,o=t.bucketName,l=Object(r.useState)(),m=l[0],f=l[1],d=Object(r.useState)(),p=d[0],b=d[1],v=Object(r.useState)(),y=v[0],h=v[1],E=Object(r.useState)(),g=E[0],k=E[1],N=Object(r.useState)(),w=N[0],x=N[1],S=[m,y,g,w].some((function(e){return"undefined"===typeof e}));return Object(r.useEffect)((function(){(function(){try{var e=localStorage.getItem("user-private-identity");return null!==e?Promise.resolve(i.Libp2pCryptoIdentity.fromString(e)):Promise.resolve(i.Libp2pCryptoIdentity.fromRandom()).then((function(e){return localStorage.setItem("user-private-identity",e.toString()),e}))}catch(t){return Promise.reject(t)}})().then(f).catch((function(){return f(null)}))}),[]),Object(r.useEffect)((function(){(function(e){try{return Promise.resolve(c.Buckets.withKeyInfo(e))}catch(t){return Promise.reject(t)}})({key:n,secret:a}).then(h).catch((function(){return h(null)}))}),[n,a,m]),Object(r.useEffect)((function(){y&&o&&m&&function(e,t,n){try{var r=!1,a=s((function(){return Promise.resolve(e.getToken(n)).then((function(){return Promise.resolve(e.open(t)).then((function(e){if("undefined"!==typeof e)return r=!0,e.key}))}))}),(function(e){throw console.log(e),e}));return Promise.resolve(a&&a.then?a.then((function(e){return r?e:null})):r?a:null)}catch(c){return Promise.reject(c)}}(y,o,m).then(k).catch((function(){return k(null)}))}),[y,o,m]),Object(r.useEffect)((function(){y&&g&&m&&(function(e,t){try{return e&&t?Promise.resolve(e.links(t)):(console.error("No bucket client or root key"),Promise.resolve(null))}catch(n){return Promise.reject(n)}}(y,g).then(x).catch((function(){return x(null)})),function(e,t){try{var n=e.pullPath(t,u);return Promise.resolve(s((function(){return console.log("reading index: start"),Promise.resolve(n.next()).then((function(e){for(var t=e.value,n="",r=0;r<t.length;r++)n+=String.fromCharCode(parseInt(t[r]));return JSON.parse(n)}))}),(function(e){throw console.error("reading index error",e),e})))}catch(r){return Promise.reject(r)}}(y,g).then(b).catch((function(){var t={author:m.public.toString(),createdAt:Date.now(),paths:[]};b(t),function(t,n,r){try{var a=e.from(JSON.stringify(r,null,2));Promise.resolve(t.pushPath(n,u,a)).then((function(){}))}catch(c){return Promise.reject(c)}}(y,g,t)})))}),[y,g,m]),{isLoading:S,identity:m,buckets:y,bucketKey:g,bucketLinks:w,bucketIndex:p}}function l(e){var t=e.bucketName,n=o({userApiKey:e.userApiKey,userApiSecret:e.userApiSecret,bucketName:t}),c=Object(r.useState)(null),i=c[0],s=c[1];return a.a.createElement(m,null,null!=n.identity&&a.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},"ID: ",n.identity.public.toString().substr(-7,7)),"undefined"!==typeof n.bucketLinks&&a.a.createElement(f,{bucketLinks:n.bucketLinks}),"undefined"!==typeof n.bucketIndex&&a.a.createElement(d,Object.assign({},n.bucketIndex,{editItem:function(e){console.log("about to edit item under a path",e)},createItem:function(){console.log("about to create item"),s({name:Date.now()+"-new-file.json",contents:""})}})),n.isLoading&&a.a.createElement(p,null),null!=i&&a.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=new FormData(e.currentTarget);console.log("form entries",[].concat(t.entries()))},onReset:function(e){console.log(new FormData(e.currentTarget)),s(null)}},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"file-name"},"File name: "),a.a.createElement("input",{type:"text",className:"form-control",name:"file-name",defaultValue:i.name})),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",{htmlFor:"file-contents"},"File name: "),a.a.createElement("textarea",{className:"form-control",rows:3,name:"file-contents",defaultValue:i.contents})),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{type:"submit",className:"btn btn-dark mr-2"},"Save"),a.a.createElement("button",{type:"reset",className:"btn btn-dark"},"Cancel"))))}function m(e){var t=e.children;return a.a.createElement("div",null,a.a.createElement("h5",{className:"card-title"},"Content manager"),t)}function f(e){var t=e.bucketLinks,n=null!==t?Object.entries(t):[];return 0===n.length?a.a.createElement("p",null,"No links to display, mate"):a.a.createElement("ul",{className:"list-group list-group-flush"},n.map((function(e,t){var n=e[0],r=e[1];return a.a.createElement("li",{className:"list-group-item",key:t},n,":"," ",a.a.createElement("a",{href:r,target:"_blank"},r.substr(0,50),"..."))})))}function d(e){var t=e.author,n=e.createdAt,r=e.paths,c=e.editItem,i=e.createItem;return a.a.createElement("section",null,a.a.createElement("header",null,a.a.createElement("br",null),a.a.createElement("h5",null,"Summary:"),"Created by ",a.a.createElement("code",null,t),a.a.createElement("p",null,"on ",a.a.createElement("time",null,new Date(n).toLocaleString()))),a.a.createElement(a.a.Fragment,null,a.a.createElement("br",null),a.a.createElement("h5",null,"Bucket index view:"),a.a.createElement("button",{type:"button",className:"btn btn-dark mb-2",onClick:function(){return i()}},"New item"),0===r.length&&a.a.createElement("p",null,"Bucket is empty."),0!==r.length&&a.a.createElement("ul",null,r.map((function(e){return a.a.createElement("li",{key:e},e," ",a.a.createElement("button",{className:"btn btn-dark mb-2",type:"button",onClick:function(){return c(e)}},"Edit"))})))))}var p=function(){return a.a.createElement("div",{className:"d-flex justify-content-center"},a.a.createElement("div",{className:"spinner-border",role:"status"},a.a.createElement("span",{className:"sr-only"},"Loading...")))}}).call(this,n(1).Buffer)},737:function(e,t,n){e.exports=n(1887)},744:function(e,t){},885:function(e,t){},901:function(e,t){},903:function(e,t){},913:function(e,t){},915:function(e,t){},940:function(e,t){},945:function(e,t){},947:function(e,t){},971:function(e,t){}},[[737,1,2]]]);